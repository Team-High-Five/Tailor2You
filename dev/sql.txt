CREATE TABLE `users` (
  `user_id` INT(5) NOT NULL AUTO_INCREMENT,
  `user_type` ENUM('tailor', 'customer', 'shopkeeper') NOT NULL,
  `first_name` VARCHAR(20) NOT NULL,
  `last_name` VARCHAR(30) NOT NULL,
  `email` VARCHAR(30) NOT NULL UNIQUE,
  `password` VARCHAR(255) NOT NULL,
  `phone_number` VARCHAR(10) NOT NULL,
  `nic` VARCHAR(12) DEFAULT NULL, -- Nullable for customers
  `birth_date` DATE DEFAULT NULL, -- Nullable for customers
  `home_town` VARCHAR(20) NOT NULL,
  `address` VARCHAR(100) NOT NULL,
  `bio` VARCHAR(255) DEFAULT NULL, -- Nullable for customers
  `category` VARCHAR(10) DEFAULT NULL, -- Nullable for customers
  `profile_pic` LONGBLOB DEFAULT NULL,
  PRIMARY KEY (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

CREATE TABLE `posts` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `user_id` INT(11) NOT NULL,
  `title` VARCHAR(255) NOT NULL,
  `description` TEXT NOT NULL,
  `image` LONGBLOB,
  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  FOREIGN KEY (`user_id`) REFERENCES `users`(`user_id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

CREATE TABLE `fabrics` (
  `fabric_id` INT(5) NOT NULL AUTO_INCREMENT,
  `tailor_id` INT(5) NOT NULL, 
  `fabric_name` VARCHAR(50) NOT NULL,
  `image` LONGBLOB DEFAULT NULL,
  `price_per_meter` DECIMAL(10, 2) NOT NULL,
  `stock` DECIMAL(10, 2) NOT NULL, 
  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP, 
  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`fabric_id`),
  FOREIGN KEY (`tailor_id`) REFERENCES `users`(`user_id`) ON DELETE CASCADE ON UPDATE CASCADE 
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

CREATE TABLE `colors` (
  `color_id` INT(5) NOT NULL AUTO_INCREMENT,
  `tailor_id` INT(5) NOT NULL,
  `color_name` VARCHAR(50) NOT NULL,
  PRIMARY KEY (`color_id`),
  FOREIGN KEY (`tailor_id`) REFERENCES `users`(`user_id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

CREATE TABLE `fabric_colors` (
  `fabric_color_id` INT(5) NOT NULL AUTO_INCREMENT,
  `fabric_id` INT(5) NOT NULL,
  `color_id` INT(5) NOT NULL,
  PRIMARY KEY (`fabric_color_id`),
  FOREIGN KEY (`fabric_id`) REFERENCES `fabrics`(`fabric_id`) ON DELETE CASCADE ON UPDATE CASCADE,
  FOREIGN KEY (`color_id`) REFERENCES `colors`(`color_id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Insert some initial data
INSERT INTO `colors` (`tailor_id`, `color_name`) VALUES (1, 'Black');
INSERT INTO `colors` (`tailor_id`, `color_name`) VALUES (1, 'Red');
INSERT INTO `colors` (`tailor_id`, `color_name`) VALUES (1, 'Blue');
INSERT INTO `colors` (`tailor_id`, `color_name`) VALUES (1, 'Purple');
INSERT INTO `colors` (`tailor_id`, `color_name`) VALUES (1, 'Orange');
INSERT INTO `colors` (`tailor_id`, `color_name`) VALUES (1, 'Yellow');
INSERT INTO `colors` (`tailor_id`, `color_name`) VALUES (1, 'Green');
INSERT INTO `colors` (`tailor_id`, `color_name`) VALUES (1, 'White');
INSERT INTO `colors` (`tailor_id`, `color_name`) VALUES (1, 'Gray');
INSERT INTO `colors` (`tailor_id`, `color_name`) VALUES (1, 'Pink');